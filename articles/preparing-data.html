<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="padlocdev">
<title>Preparing padloc-db data for use • padlocdev</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Preparing padloc-db data for use">
<meta property="og:description" content="padlocdev">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">padlocdev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/padlocdev.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/generate-files.html">Generate files</a>
    <a class="dropdown-item" href="../articles/preparing-data.html">Preparing padloc-db data for use</a>
    <a class="dropdown-item" href="../articles/reading-data.html">Reading padloc-db data</a>
    <a class="dropdown-item" href="../articles/validating-data.html">Validating padloc-db data</a>
    <a class="dropdown-item" href="../articles/workflow.html">Summarised workflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/leightonpayne/padlocdev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Preparing padloc-db data for use</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leightonpayne/padlocdev/blob/HEAD/vignettes/preparing-data.Rmd" class="external-link"><code>vignettes/preparing-data.Rmd</code></a></small>
      <div class="d-none name"><code>preparing-data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leightonpayne/padlocdev" class="external-link">padlocdev</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="spliting-a-database-into-groups">Spliting a database into groups<a class="anchor" aria-label="anchor" href="#spliting-a-database-into-groups"></a>
</h4>
<p>Once a padloc-db is validated, it is useful to split it into groups
for batched searches with padloc.</p>
<p>Read <code>sys_groups.txt</code> using
<code><a href="../reference/read_sys_groups.html">read_sys_groups()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"sys_groups.txt"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't find package file.</span></span>
<span><span class="va">sys_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_sys_groups.html">read_sys_groups</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'path' not found</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sys_groups</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'sys_groups' not found</span></span></code></pre></div>
<p>Use <code><a href="../reference/filter_models.html">filter_models()</a></code> to filter a list of padloc models
for those belonging to a particular group, as defined in the system
groups table.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"sys"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't find package file.</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multi_read_padloc_model.html">multi_read_padloc_model</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'path' not found</span></span>
<span><span class="va">models_group_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_models.html">filter_models</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">sys_groups</span>, <span class="st">"group_1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'sys_groups' not found</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models_group_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'models_group_1' not found</span></span></code></pre></div>
<p>To pull</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"hmm_meta.txt"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/read_hmm_meta.html">read_hmm_meta</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Can't find package file.</span></span>
<span><span class="va">hmm_meta_expanded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_hmm_meta.html">expand_hmm_meta</a></span><span class="op">(</span><span class="va">hmm_meta</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'hmm_meta' not found</span></span>
<span><span class="va">hmm_meta_group_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_hmm_meta.html">filter_hmm_meta</a></span><span class="op">(</span><span class="va">models_group_1</span>, <span class="va">hmm_meta_expanded</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'models_group_1' not found</span></span></code></pre></div>
<p>To copy HMMs from a particular system group to a new directory use
<code><a href="../reference/system_cp_hmm.html">system_cp_hmm()</a></code>. This, and related <code>system_cp_*</code>
functions, use the <code>?fs</code> package to manipulate system
files.</p>
<p>Before trying to copy any HMMs, it’s important to verify that the
name of the HMM file corresponds with the accession
i.e. <code>ACC</code> field in the HMM header. This is not important for
function of the database, though it is probably good practice, and it is
important for this exercise as the accession is what we’ll be using to
identify HMMs to copy.</p>
<p>Use <code><a href="../reference/verify_hmm_names.html">verify_hmm_names()</a></code> to check that the names match. It
returns a <code>list</code> of two <code>tibbles</code>,
<code>names_match</code> which lists HMMs with matching file and
accession names, and <code>names_mismatch</code> which lists HMMs with
different file and accession names.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_1_names_verify</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/verify_hmm_names.html">verify_hmm_names</a></span><span class="op">(</span><span class="va">models_group_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'models_group_1' not found</span></span>
<span><span class="va">group_1_names_verify</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'group_1_names_verify' not found</span></span></code></pre></div>
<p>In this case all names match, so we can continue. Use
<code><a href="../reference/filter_hmm_meta.html">filter_hmm_meta()</a></code> to extract rows from the HMM metadata
table that are actually relevant to</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/system_cp_hmm.html">system_cp_hmm</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in system_cp_hmm(): argument "new_path" is missing, with no default</span></span></code></pre></div>
<p>Use the wrapper <code><a href="../reference/divide_database.html">divide_database()</a></code> to create
sub-databases for all groups in the system groups table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># divide_database(</span></span>
<span> <span class="co">#   sys_expanded = sys_expanded,</span></span>
<span> <span class="co">#   sys_groups = sys_groups,</span></span>
<span> <span class="co">#   hmm_meta_expanded = hmm_meta_expanded,</span></span>
<span> <span class="co">#   sys_meta = sys_meta</span></span>
<span> <span class="co">#   path = "path/to/database",</span></span>
<span> <span class="co">#   new_path = "/path/to/new/database"</span></span>
<span> <span class="co"># )</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="section"></h2>
</div>
<div class="section level2">
<h2 id="r-message-false">
<code>{r, message = FALSE} #  #</code><a class="anchor" aria-label="anchor" href="#r-message-false"></a>
</h2>
</div>
<div class="section level2">
<h2 id="section-1"></h2>
</div>
<div class="section level2">
<h2 id="r-message-false-1">
<code>{r, message = FALSE} #  #</code><a class="anchor" aria-label="anchor" href="#r-message-false-1"></a>
</h2>
</div>
<div class="section level2">
<h2 id="section-2"></h2>
</div>
<div class="section level2">
<h2 id="r-message-false-2">
<code>{r, message = FALSE} #  #</code><a class="anchor" aria-label="anchor" href="#r-message-false-2"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Leighton Payne.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
