<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="padlocdev">
<title>Validating padloc-db data • padlocdev</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Validating padloc-db data">
<meta property="og:description" content="padlocdev">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">padlocdev</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/padlocdev.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/preparing-data.html">Preparing padloc-db data for use</a>
    <a class="dropdown-item" href="../articles/reading-data.html">Reading padloc-db data</a>
    <a class="dropdown-item" href="../articles/validating-data.html">Validating padloc-db data</a>
    <a class="dropdown-item" href="../articles/workflow.html">Summarised workflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/leightonpayne/padlocdev/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Validating padloc-db data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leightonpayne/padlocdev/blob/HEAD/vignettes/validating-data.Rmd" class="external-link"><code>vignettes/validating-data.Rmd</code></a></small>
      <div class="d-none name"><code>validating-data.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="expanding-hmm-metadata-table">Expanding HMM metadata table<a class="anchor" aria-label="anchor" href="#expanding-hmm-metadata-table"></a>
</h3>
<p>The raw HMM metadata table read-in by <code><a href="../reference/read_hmm_meta.html">read_hmm_meta()</a></code>
can have multiple names listed in <code>protein.name</code> and
<code>secondary.name</code> (separated by the delimiter <code>|</code>).
To split these assignments into multiple rows, use
<code><a href="../reference/expand_hmm_meta.html">expand_hmm_meta()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db/hmm_meta.txt"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/read_hmm_meta.html">read_hmm_meta</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"HamA"</span>, <span class="va">protein.name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 15</span></span></span>
<span><span class="co">#&gt;   hmm.acc hmm.name hmm.description protein.name secondary.name author number.seq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC00… HamA1_0… DUF1837 domain  HamA1|HamA   <span style="color: #BB0000;">NA</span>             Payne…         49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PDLC00… HamA1_0… DUF1837 domain  HamA1|HamA   <span style="color: #BB0000;">NA</span>             Payne…          6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PDLC00… HamA2_0… DUF1837 domain  HamA2|HamA   <span style="color: #BB0000;">NA</span>             Payne…          7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PDLC00… HamA2_0… DUF1837 domain  HamA2|HamA   <span style="color: #BB0000;">NA</span>             Payne…        144</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: length.hmm &lt;dbl&gt;, e.value.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hmm.coverage.threshold &lt;dbl&gt;, target.coverage.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   system &lt;chr&gt;, literature.ref &lt;chr&gt;, database.ref &lt;chr&gt;, comments &lt;chr&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta_expanded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_hmm_meta.html">expand_hmm_meta</a></span><span class="op">(</span><span class="va">hmm_meta</span><span class="op">)</span></span>
<span><span class="va">hmm_meta_expanded</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"HamA"</span>, <span class="va">protein.name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 15</span></span></span>
<span><span class="co">#&gt;   hmm.acc hmm.name hmm.description protein.name secondary.name author number.seq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC00… HamA1_0… DUF1837 domain  HamA1        <span style="color: #BB0000;">NA</span>             Payne…         49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PDLC00… HamA1_0… DUF1837 domain  HamA         <span style="color: #BB0000;">NA</span>             Payne…         49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PDLC00… HamA1_0… DUF1837 domain  HamA1        <span style="color: #BB0000;">NA</span>             Payne…          6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PDLC00… HamA1_0… DUF1837 domain  HamA         <span style="color: #BB0000;">NA</span>             Payne…          6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> PDLC00… HamA2_0… DUF1837 domain  HamA2        <span style="color: #BB0000;">NA</span>             Payne…          7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> PDLC00… HamA2_0… DUF1837 domain  HamA         <span style="color: #BB0000;">NA</span>             Payne…          7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> PDLC00… HamA2_0… DUF1837 domain  HamA2        <span style="color: #BB0000;">NA</span>             Payne…        144</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> PDLC00… HamA2_0… DUF1837 domain  HamA         <span style="color: #BB0000;">NA</span>             Payne…        144</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: length.hmm &lt;dbl&gt;, e.value.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hmm.coverage.threshold &lt;dbl&gt;, target.coverage.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   system &lt;chr&gt;, literature.ref &lt;chr&gt;, database.ref &lt;chr&gt;, comments &lt;chr&gt;</span></span></span></code></pre></div>
<p>The HMM metadata table can be re-collapsed using
<code><a href="../reference/collapse_hmm_meta.html">collapse_hmm_meta()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta_collapsed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/collapse_hmm_meta.html">collapse_hmm_meta</a></span><span class="op">(</span><span class="va">hmm_meta_expanded</span><span class="op">)</span></span>
<span><span class="va">hmm_meta_collapsed</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"HamA"</span>, <span class="va">protein.name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 15</span></span></span>
<span><span class="co">#&gt;   hmm.acc hmm.name hmm.description protein.name secondary.name author number.seq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC00… HamA1_0… DUF1837 domain  HamA1|HamA   NA             Payne…         49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PDLC00… HamA1_0… DUF1837 domain  HamA1|HamA   NA             Payne…          6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PDLC00… HamA2_0… DUF1837 domain  HamA2|HamA   NA             Payne…          7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PDLC00… HamA2_0… DUF1837 domain  HamA2|HamA   NA             Payne…        144</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: length.hmm &lt;dbl&gt;, e.value.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hmm.coverage.threshold &lt;dbl&gt;, target.coverage.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   system &lt;chr&gt;, literature.ref &lt;chr&gt;, database.ref &lt;chr&gt;, comments &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="expanding-secondary-gene-assignments">Expanding secondary gene assignments<a class="anchor" aria-label="anchor" href="#expanding-secondary-gene-assignments"></a>
</h3>
<p>Raw system model files can contain references to gene groups a.k.a
<code>secondary.name</code> assignments. Before testing model validity,
these gene groups need to be expanded.</p>
<p>First, read in the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db/sys/DRT_class_II.yaml"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/read_padloc_model.html">read_padloc_model</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The model for <code>DRT_class_II</code> has one ‘<code>gene</code>’
in <code>optional_genes</code> i.e.  <code>Drt_class_II</code> which is
actually a group of genes.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">[[</span><span class="st">"core_genes"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Drt_class_II"</span></span></code></pre></div>
<p>Several genes in the HMM metadata table have been assigned
<code>Drt_class_II</code> as a <code>secondary.name</code> to group them
together.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta_expanded</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">secondary.name</span> <span class="op">==</span> <span class="st">"Drt_class_II"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 15</span></span></span>
<span><span class="co">#&gt;   hmm.acc hmm.name hmm.description protein.name secondary.name author number.seq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC02… Drt2_00… <span style="color: #BB0000;">NA</span>              Drt2         Drt_class_II   Payne…         92</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PDLC02… Drt3a_0… <span style="color: #BB0000;">NA</span>              Drt3a        Drt_class_II   Payne…         53</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PDLC02… Drt3a_0… <span style="color: #BB0000;">NA</span>              Drt3a        Drt_class_II   Payne…         68</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PDLC02… Drt3b_0… <span style="color: #BB0000;">NA</span>              Drt3b        Drt_class_II   Payne…        107</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: length.hmm &lt;dbl&gt;, e.value.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hmm.coverage.threshold &lt;dbl&gt;, target.coverage.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   system &lt;chr&gt;, literature.ref &lt;chr&gt;, database.ref &lt;chr&gt;, comments &lt;chr&gt;</span></span></span></code></pre></div>
<p>Use <code><a href="../reference/expand_gene_groups.html">expand_gene_groups()</a></code> to expand gene groups for a
particuar gene category, based on the <code>secondary.name</code>
assignments in the HMM metadata table.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_gene_groups.html">expand_gene_groups</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">"core_genes"</span>, <span class="va">hmm_meta_expanded</span><span class="op">)</span></span>
<span><span class="va">genes</span></span>
<span><span class="co">#&gt; [1] "Drt2"  "Drt3a" "Drt3b"</span></span></code></pre></div>
<p>These can be assigned back onto the model. Other genes that are
listed in the gene category being expanded, and are not part of a gene
group will also get carried over.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">[[</span><span class="st">"core_genes"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">genes</span></span>
<span><span class="va">model</span><span class="op">[[</span><span class="st">"core_genes"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "Drt2"  "Drt3a" "Drt3b"</span></span></code></pre></div>
<p>A wrapper is provided to expand the gene assignments for all gene
categories of all system models in a list, and assign them back onto the
models.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db/sys"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/multi_read_padloc_model.html">multi_read_padloc_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">models</span><span class="op">[[</span><span class="st">"DRT_class_II"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"core_genes"</span>, <span class="st">"optional_genes"</span>, <span class="st">"prohibited_genes"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; $core_genes</span></span>
<span><span class="co">#&gt; [1] "Drt_class_II"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $optional_genes</span></span>
<span><span class="co">#&gt; [1] "NA"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prohibited_genes</span></span>
<span><span class="co">#&gt; [1] "Drt_class_I"   "Drt_class_III"</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models_expanded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_gene_groups_all.html">expand_gene_groups_all</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">hmm_meta_expanded</span><span class="op">)</span></span>
<span><span class="va">models_expanded</span><span class="op">[[</span><span class="st">"DRT_class_II"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"core_genes"</span>, <span class="st">"optional_genes"</span>, <span class="st">"prohibited_genes"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; $core_genes</span></span>
<span><span class="co">#&gt; [1] "Drt2"  "Drt3a" "Drt3b"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $optional_genes</span></span>
<span><span class="co">#&gt; [1] "NA"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prohibited_genes</span></span>
<span><span class="co">#&gt; [1] "Drt1a" "Drt1b" "Drt4"  "Drt5"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-through-an-example-of-a-broken-database">Working through an example of a broken database<a class="anchor" aria-label="anchor" href="#working-through-an-example-of-a-broken-database"></a>
</h3>
<p>An example of a broken database with various issues has been
included, to demonstrate database validation functions. First, we’ll
read in the database files.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path_hmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db-broken/hmm"</span><span class="op">)</span></span>
<span><span class="va">path_sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db-broken/sys"</span><span class="op">)</span></span>
<span><span class="va">path_hmm_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db-broken/hmm_meta.txt"</span><span class="op">)</span></span>
<span><span class="va">path_sys_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db-broken/sys_meta.txt"</span><span class="op">)</span></span>
<span><span class="va">path_sys_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/padlocdev_example.html">padlocdev_example</a></span><span class="op">(</span><span class="st">"padloc-db-broken/sys_groups.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hmms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multi_read_hmm_header.html">multi_read_hmm_header</a></span><span class="op">(</span><span class="va">path_hmm</span><span class="op">)</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multi_read_padloc_model.html">multi_read_padloc_model</a></span><span class="op">(</span><span class="va">path_sys</span><span class="op">)</span></span>
<span><span class="va">hmm_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_hmm_meta.html">read_hmm_meta</a></span><span class="op">(</span><span class="va">path_hmm_meta</span><span class="op">)</span></span>
<span><span class="va">sys_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_sys_meta.html">read_sys_meta</a></span><span class="op">(</span><span class="va">path_sys_meta</span><span class="op">)</span></span>
<span><span class="va">sys_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_sys_groups.html">read_sys_groups</a></span><span class="op">(</span><span class="va">path_sys_groups</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="verify-that-hmm-file-names-match-their-accession">Verify that HMM file names match their accession<a class="anchor" aria-label="anchor" href="#verify-that-hmm-file-names-match-their-accession"></a>
</h4>
<p>Before trying to expand anything, lets see if there’s anything
missing. First, we’ll check that the HMM file names match their
accessions, as this may affect other stages of validation. To do this,
use <code><a href="../reference/verify_hmm_names.html">verify_hmm_names()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_name_verification</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/verify_hmm_names.html">verify_hmm_names</a></span><span class="op">(</span><span class="va">hmms</span><span class="op">)</span></span>
<span><span class="va">hmm_name_verification</span></span>
<span><span class="co">#&gt; $names_match</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 40 × 3</span></span></span>
<span><span class="co">#&gt;    file_name accession_field match</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> PDLC00150 PDLC00150       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PDLC00151 PDLC00151       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PDLC00174 PDLC00174       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> PDLC00175 PDLC00175       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> PDLC00195 PDLC00195       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> PDLC00196 PDLC00196       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PDLC00199 PDLC00199       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PDLC00200 PDLC00200       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PDLC00202 PDLC00202       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PDLC00203 PDLC00203       TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 30 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $names_mismatch</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   file_name accession_field match</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC02505 PDLC00012       FALSE</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PDLC03000 PDLC02511       FALSE</span></span></code></pre></div>
<p>Here, we can see that the HMMs with filenames
<code>PDLC03000.hmm</code> and <code>PDLC02505.hmm</code> do not have
matching accession fields. It’s unclear whether the filename or the
accession fields are incorrect, but we could check whether there are
mentions of either of these HMMs in the metadata table to
investigate.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  file_names <span class="op">=</span> <span class="va">hmm_name_verification</span><span class="op">[[</span><span class="st">"names_mismatch"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"file_name"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  accessions <span class="op">=</span> <span class="va">hmm_name_verification</span><span class="op">[[</span><span class="st">"names_mismatch"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"accession_field"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">in_hmm_meta</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">check</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hmm_meta</span>, <span class="va">hmm.acc</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">in_hmm_meta</span></span>
<span><span class="co">#&gt; $file_names</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 15</span></span></span>
<span><span class="co">#&gt;   hmm.acc hmm.name hmm.description protein.name secondary.name author number.seq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC02… BrxL_00… BrxL            BrxL         <span style="color: #BB0000;">NA</span>             Payne…         <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: length.hmm &lt;dbl&gt;, e.value.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hmm.coverage.threshold &lt;dbl&gt;, target.coverage.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   system &lt;chr&gt;, literature.ref &lt;chr&gt;, database.ref &lt;chr&gt;, comments &lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accessions</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 15</span></span></span>
<span><span class="co">#&gt;   hmm.acc hmm.name hmm.description protein.name secondary.name author number.seq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC02… BrxP_00… BrxP            BrxP         <span style="color: #BB0000;">NA</span>             Payne…         <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: length.hmm &lt;dbl&gt;, e.value.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   hmm.coverage.threshold &lt;dbl&gt;, target.coverage.threshold &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   system &lt;chr&gt;, literature.ref &lt;chr&gt;, database.ref &lt;chr&gt;, comments &lt;chr&gt;</span></span></span></code></pre></div>
<p>Now we can see that the HMM with filename <code>PDLC02505.hmm</code>
has an entry in the HMM metadata table, so the accession is most likely
what is incorrect, and should be updated to be <code>PDLC02505</code>.
In addition, the HMM with accession <code>PDLC02511</code> has an entry
in the metadata table, so the filename <code>PDLC03000.hmm</code> should
be updated to be <code>PDLC02511.hmm</code>.</p>
<p>If any HMMs listed in the mismatch table did not show up in the
metadata table, we might deduce that both the filename and the accession
are incorrect, or this HMM hasn’t been added to the metadata table yet
(the name mismatch should be resolved before adding), or the HMM has
been included in the <code>hmm</code> directory in error. Either way,
these cases should also be dealt with.</p>
</div>
<div class="section level4">
<h4 id="compare-the-profile-hmms-with-the-hmm-metadata-table">Compare the profile HMMs with the HMM metadata table<a class="anchor" aria-label="anchor" href="#compare-the-profile-hmms-with-the-hmm-metadata-table"></a>
</h4>
<p>Next, we’ll compare the HMMs with the metadata table, to ensure that
all HMMs have an entry and vice-versa. To do this, use
<code><a href="../reference/compare_hmm_files_hmm_meta.html">compare_hmm_files_hmm_meta()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_hmm_files_hmm_meta.html">compare_hmm_files_hmm_meta</a></span><span class="op">(</span><span class="va">hmms</span>, <span class="va">hmm_meta</span><span class="op">)</span></span>
<span><span class="va">comparison</span></span>
<span><span class="co">#&gt; $`hmm_files without hmm_meta`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   file.name NAME              ACC       hmm_files</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> PDLC04000 Extra_HMM         PDLC04000 TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> PDLC05000 Another_extra_HMM PDLC05000 TRUE     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`hmm_meta without hmm_files`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   hmm.name   hmm_meta</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BrxA_00001 TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> BrxE_00001 TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BrxP_00001 TRUE    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`hmm_files with hmm_meta`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 40 × 3</span></span></span>
<span><span class="co">#&gt;    hmm.name    hmm_files hmm_meta</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> HamA1_00001 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> HamA1_00002 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> HamB1_00001 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> HamB1_00002 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> HamA2_00001 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> HamA2_00002 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> HamB2_00001 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> HamB2_00002 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> HamC2_00001 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> HamC2_00002 TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 30 more rows</span></span></span></code></pre></div>
<p>Here, we can see that there are two HMMs that exist, but are not
mentioned in the HMM metadata table: <code>PDLC04000.hmm</code> and
<code>PDLC05000.hmm</code>. There are also three HMMs that are mentioned
in the metadata table but do not exist: <code>BrxA_00001</code>,
<code>BrxE_00001</code>, and <code>BrxP_00001</code>.</p>
</div>
<div class="section level4">
<h4 id="compare-the-system-models-with-the-system-metadata-table">Compare the system models with the system metadata table<a class="anchor" aria-label="anchor" href="#compare-the-system-models-with-the-system-metadata-table"></a>
</h4>
<p>Next, we’ll compare the system models with the system metadata table,
to ensure that all systems have an entry and vice-versa. To do this, use
<code><a href="../reference/compare_sys_files_sys_meta.html">compare_sys_files_sys_meta()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_sys_files_sys_meta.html">compare_sys_files_sys_meta</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">sys_meta</span><span class="op">)</span></span>
<span><span class="va">comparison</span></span>
<span><span class="co">#&gt; $`sys_files without sys_meta`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   yaml.name        sys_files</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> brex_other       TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> generic_system_A TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> generic_system_B TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> hachiman_type_I  TRUE     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`sys_meta without sys_files`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   yaml.name        sys_meta</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> brex_type_II     TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> DRT_type_II      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> hachiman_type_II TRUE    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`sys_files with sys_meta`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 3</span></span></span>
<span><span class="co">#&gt;    yaml.name      sys_files sys_meta</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> brex_type_I    TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> brex_type_III  TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> brex_type_IV   TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> brex_type_V    TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> brex_type_VI   TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> DRT_class_I    TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> DRT_class_II   TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> DRT_class_III  TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> DRT_other      TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DRT_type_I     TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> DRT_type_III   TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> DRT_type_IV    TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> DRT_type_V     TRUE      TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> hachiman_other TRUE      TRUE</span></span></code></pre></div>
<p>Here, we can see that four system models do not have entries in the
system metadata table: <code>brex_other</code>,
<code>generic_system_A</code>, <code>generic_system_B</code>, and
<code>hachiman_type_I</code>. Additionaly, there are three entries in
the metadata table that do not have corresponding system models:
<code>brex_type_II</code>, <code>DRT_type_II</code>, and
<code>hachiman_type_II</code>.</p>
</div>
<div class="section level4">
<h4 id="compare-the-system-metadata-table-with-the-system-groups-table">Compare the system metadata table with the system groups table<a class="anchor" aria-label="anchor" href="#compare-the-system-metadata-table-with-the-system-groups-table"></a>
</h4>
<p>Next, we’ll compare the system metadata table with the system groups
table, to ensure that all system models have been assigned to a group.
To do this, use <code><a href="../reference/compare_sys_meta_sys_groups.html">compare_sys_meta_sys_groups()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_sys_meta_sys_groups.html">compare_sys_meta_sys_groups</a></span><span class="op">(</span><span class="va">sys_meta</span>, <span class="va">sys_groups</span><span class="op">)</span></span>
<span><span class="va">comparison</span></span>
<span><span class="co">#&gt; $`sys_meta without sys_groups`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   yaml.name      sys_meta</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> DRT_class_I    TRUE    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> hachiman_other TRUE    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`sys_groups without sys_meta`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   yaml.name       sys_groups</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> brex_other      TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> hachiman_type_I TRUE      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`sys_meta with sys_groups`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 3</span></span></span>
<span><span class="co">#&gt;    yaml.name        sys_meta sys_groups</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> brex_type_I      TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> brex_type_II     TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> brex_type_III    TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> brex_type_IV     TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> brex_type_V      TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> brex_type_VI     TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> DRT_class_II     TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> DRT_class_III    TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> DRT_other        TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DRT_type_I       TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> DRT_type_II      TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> DRT_type_III     TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> DRT_type_IV      TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> DRT_type_V       TRUE     TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> hachiman_type_II TRUE     TRUE</span></span></code></pre></div>
<p>Here, we can see that two systems with entries in the metadata table
have not been assigned system groups: <code>DRT_class_I</code> and
<code>hachiman_other</code>. Additionally, two of the systems that were
previously identified as having missing entries in the metadata table
have been assigned groups: <code>brex_other</code> and
<code>hachiman_type_I</code>. The systems <code>generic_system_A</code>
and <code>generic_system_B</code> do not appear here as they do not have
entries in the metadata table or the system groups table.</p>
</div>
<div class="section level4">
<h4 id="compare-the-system-models-with-the-hmm-metadata-table">Compare the system models with the HMM metadata table<a class="anchor" aria-label="anchor" href="#compare-the-system-models-with-the-hmm-metadata-table"></a>
</h4>
<p>Once the above issues have been resolved, we can expand the hmm
metadata table and the system models (for the purposes of this example,
we won’t be correcting the issues here).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hmm_meta_expanded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_hmm_meta.html">expand_hmm_meta</a></span><span class="op">(</span><span class="va">hmm_meta</span><span class="op">)</span></span>
<span><span class="va">models_expanded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expand_gene_groups_all.html">expand_gene_groups_all</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">hmm_meta_expanded</span><span class="op">)</span></span></code></pre></div>
<p>Now we can compare the expanded models with the expanded metadata
table to ensure that all genes mentioned in the models have entries in
the metadata table and vice-versa. Use
<code><a href="../reference/compare_sys_files_hmm_meta.html">compare_sys_files_hmm_meta()</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_sys_files_hmm_meta.html">compare_sys_files_hmm_meta</a></span><span class="op">(</span><span class="va">models_expanded</span>, <span class="va">hmm_meta_expanded</span><span class="op">)</span></span>
<span><span class="va">comparison</span></span>
<span><span class="co">#&gt; $`hmm_meta_expanded without sys_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   protein.name hmm_meta_expanded</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> HamA2        TRUE             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> HamB2        TRUE             </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`sys_genes without hmm_meta_expanded`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   protein.name sys_genes</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> GenA         TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> GenB         TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> GenC         TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> GenD         TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> GenE         TRUE     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`hmm_meta_expanded with sys_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 3</span></span></span>
<span><span class="co">#&gt;    protein.name hmm_meta_expanded sys_genes</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> HamA1        TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> HamA         TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> HamB1        TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> HamB         TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> HamC2        TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> HamC         TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Drt1a        TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Drt1b        TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Drt2         TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Drt3a        TRUE              TRUE     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more rows</span></span></span></code></pre></div>
<p>Here, we can see that there are two genes in the HMM metadata table
that are not used in any of the system models: <code>HamA2</code> and
<code>HamB2</code>. This is perhaps unsuprising, as we <a href="#compare-the-system-models-with-the-system-metadata-table">already
established</a> that there is no system model present for
<code>hachiman_type_II</code>, which would use these genes. In addition,
there are five genes used by system models which are not referenced in
the HMM metadata table: <code>GenA</code>, <code>GenB</code>,
<code>GenC</code>, <code>GenD</code>, and <code>GenE</code>. To see
which systems use those genes, we can use <code><a href="../reference/which_uses.html">which_uses()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genes_without_meta</span> <span class="op">&lt;-</span> <span class="va">comparison</span><span class="op">[[</span><span class="st">"sys_genes without hmm_meta_expanded"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"protein.name"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/which_uses.html">which_uses</a></span><span class="op">(</span><span class="va">genes_without_meta</span>, <span class="va">models_expanded</span><span class="op">)</span></span>
<span><span class="co">#&gt; $GenA</span></span>
<span><span class="co">#&gt; [1] "generic_system_A" "generic_system_A"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GenB</span></span>
<span><span class="co">#&gt; [1] "generic_system_A" "generic_system_A"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GenC</span></span>
<span><span class="co">#&gt; [1] "generic_system_B"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GenD</span></span>
<span><span class="co">#&gt; [1] "generic_system_B"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $GenE</span></span>
<span><span class="co">#&gt; [1] "generic_system_B"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="checking-that-system-models-are-valid">Checking that system models are valid<a class="anchor" aria-label="anchor" href="#checking-that-system-models-are-valid"></a>
</h4>
<p>Now we’ve checked that all information is present in the database
(and fixed any issues), we can now check each of the system models to
ensure that they are actually capable of identifying systems with their
given parameters.</p>
<p>Use <code><a href="../reference/valid_padloc_model.html">valid_padloc_model()</a></code> for assessing model validity.
This function provides useful error information for fixing a model if it
is invalid. It should be after expanding gene groups.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models_expanded</span><span class="op">[[</span><span class="st">"brex_type_III"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $maximum_separation</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $minimum_core</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $minimum_total</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $core_genes</span></span>
<span><span class="co">#&gt; [1] "BrxA"   "BrxC"   "BrxF"   "PglXI"  "BrxHII" "PglZ"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $optional_genes</span></span>
<span><span class="co">#&gt; [1] "NA"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prohibited_genes</span></span>
<span><span class="co">#&gt; [1] "NA"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/valid_padloc_model.html">valid_padloc_model</a></span><span class="op">(</span><span class="va">models_expanded</span><span class="op">[[</span><span class="st">"brex_type_III"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models_expanded</span><span class="op">[[</span><span class="st">"brex_type_I"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $maximum_separation</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $minimum_core</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $minimum_total</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $core_genes</span></span>
<span><span class="co">#&gt; [1] "BrxA" "BrxB" "BrxC" "PglX" "PglZ" "BrxL"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $optional_genes</span></span>
<span><span class="co">#&gt; [1] "BrxA"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prohibited_genes</span></span>
<span><span class="co">#&gt; [1] "BrxE"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/valid_padloc_model.html">valid_padloc_model</a></span><span class="op">(</span><span class="va">models_expanded</span><span class="op">[[</span><span class="st">"brex_type_I"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `valid_padloc_model()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid padloc system model:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_core` must be &lt;= the number of `core_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_core` is <span style="color: #0000BB;">7</span>, but number of `core_genes` is <span style="color: #0000BB;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `core_genes` should not overlap with `optional_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Overlapping genes include: <span style="color: #0000BB;">"BrxA"</span></span></span></code></pre></div>
<p>The model for <code>brex_type_I</code> is invalid, as the required
number of core genes is greater than the number of core genes specifed.
Additionaly, the gene <code>BrxA</code> has been specified in both the
<code>core_genes</code> and <code>optional_genes</code>.</p>
<p>The wrapper <code><a href="../reference/report_padloc_model_validity.html">report_padloc_model_validity()</a></code> is provided
to test the validity of all system models in a list and return the
output as a <code>list</code> of <code><a href="https://purrr.tidyverse.org/reference/safely.html" class="external-link">?purrr::safely</a></code>-style
sub-<code>lists</code> with two components <code>result</code> and
<code>error</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validity_report</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report_padloc_model_validity.html">report_padloc_model_validity</a></span><span class="op">(</span><span class="va">models_expanded</span><span class="op">)</span></span></code></pre></div>
<p>For each model, if it is valid, <code>result</code> is
<code>TRUE</code> and <code>error</code> is <code>NULL</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validity_report</span><span class="op">[[</span><span class="st">"DRT_class_II"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $result</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $error</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>If the model is invalid, <code>result</code> is <code>FALSE</code>
and <code>error</code> is an <code><a href="https://rlang.r-lib.org/reference/rlang_error.html" class="external-link">?rlang::rlang_error</a></code> object
that describes the reason the model is invalid.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validity_report</span><span class="op">[[</span><span class="st">"brex_type_I"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $result</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $error</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">&lt;error/rlang_error&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid padloc system model:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_core` must be &lt;= the number of `core_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_core` is <span style="color: #0000BB;">7</span>, but number of `core_genes` is <span style="color: #0000BB;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `core_genes` should not overlap with `optional_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Overlapping genes include: <span style="color: #0000BB;">"BrxA"</span></span></span></code></pre></div>
<p>To return just the error messages for all model in the list, use
<code><a href="../reference/why_invalid.html">why_invalid()</a></code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/why_invalid.html">why_invalid</a></span><span class="op">(</span><span class="va">validity_report</span><span class="op">)</span></span>
<span><span class="co">#&gt; $brex_type_I</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">&lt;error/rlang_error&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid padloc system model:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_core` must be &lt;= the number of `core_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_core` is <span style="color: #0000BB;">7</span>, but number of `core_genes` is <span style="color: #0000BB;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `core_genes` should not overlap with `optional_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Overlapping genes include: <span style="color: #0000BB;">"BrxA"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DRT_type_I</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">&lt;error/rlang_error&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid padloc system model:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `maximum_separation` must be a whole number of type <span style="font-style: italic;">integer</span> or <span style="font-style: italic;">double</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Instead, got <span style="font-style: italic;">character</span>: <span style="color: #0000BB;">zero</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_core` must be a whole number of type <span style="font-style: italic;">integer</span> or <span style="font-style: italic;">double</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Instead, got <span style="font-style: italic;">character</span>: <span style="color: #0000BB;">two</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_total` must be a whole number of type <span style="font-style: italic;">integer</span> or <span style="font-style: italic;">double</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Instead, got <span style="font-style: italic;">character</span>: <span style="color: #0000BB;">two</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_core` must be &lt;= the number of `core_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_core` is <span style="color: #0000BB;">"two"</span>, but number of `core_genes` is <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_total` must be &lt;= the combined number of `core_genes` and</span></span>
<span><span class="co">#&gt; `optional_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_total` is <span style="color: #0000BB;">"two"</span>, but `core_genes` + `optional_genes` is <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $DRT_type_III</span></span>
<span><span class="co">#&gt; &lt;simpleError: the condition has length &gt; 1&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $generic_system_A</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">&lt;error/rlang_error&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid padloc system model:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_core` must be &lt;= the number of `core_genes`</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_core` is <span style="color: #0000BB;">3</span>, but number of `core_genes` is <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `minimum_total` must be &lt;= the combined number of `core_genes` and</span></span>
<span><span class="co">#&gt; `optional_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> `minimum_total` is <span style="color: #0000BB;">4</span>, but `core_genes` + `optional_genes` is <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `core_genes` should not overlap with `optional_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Overlapping genes include: <span style="color: #0000BB;">"GenB"</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `core_genes` should not overlap with `prohibited_genes`.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Overlapping genes include: <span style="color: #0000BB;">"GenA"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $generic_system_B</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB; font-weight: bold;">&lt;error/rlang_error&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Invalid padloc system model:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `core_genes` can not contain the special value <span style="color: #0000BB;">"NA"</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Got <span style="color: #0000BB;">"GenC"</span>, <span style="color: #0000BB;">"GenD"</span>, and <span style="color: #0000BB;">"NA"</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> `optional_genes` can not contain the special value <span style="color: #0000BB;">"NA"</span> if additional genes</span></span>
<span><span class="co">#&gt; are specified.</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> Got <span style="color: #0000BB;">"GenE"</span> and <span style="color: #0000BB;">"NA"</span>.</span></span></code></pre></div>
<p>Some malformed models may fail for reasons outside of the scope of
the current validity checks, resulting in cryptic error messages, like
that seen for <code>DRT_type_III</code>. These models should be
inspected manually for the cause of the error.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">validity_report</span><span class="op">[[</span><span class="st">"DRT_type_III"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $result</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $error</span></span>
<span><span class="co">#&gt; &lt;simpleError: the condition has length &gt; 1&gt;</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Leighton Payne.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
